<div id="fr-index-agency-metadata" class="page_summary">
  <h1>
    <%= link_to agency_name, '', :class => 'agency' %>
    <!-- BC TODO: Link to live path -->
  </h1>
  <%= link_to "Return to the agency list for the #{year} FR Index", year_agency_path(year, agency_slug)  %>

  <hr />

  <!-- B.B. TODO: Turn this into a helper and allow arbitrary conditions to be passed. -->
  <%#= render :partial => 'agencies/embedded_search', :locals => {:search => @search, :agency_year => year} %>

  <%# if agency_year.last_published %>
    <%#= link_to "Download Approved #{agency_year.last_published.to_s(:month_year)} #{agency_year.name} Index (PDF)", agency_year.published_pdf_path, :class => "pdf_link" %>
  <%# end %>

  <hr />

  <p>
    <% if year == Date.current.strftime("%Y")%>
    <!-- TODO: Are we sure year input is integer -->
      As of <strong>Stubbed Date<%#= agency_year.max_date.strftime("%B %e, %Y") %></strong> the <%= agency_name %> has published
      <%= pluralize total_document_count, "document" %> in <%= year %>.
    <% else %>
      In <%= year %> the <%= agency_name %> published <%= pluralize total_document_count, "document" %>.
    <% end %>
  </p>

  <table>
    <tr>
      <th>Document Type</th>
      <th>Documents Published</th>
      <th>Subjects Covered</th>
    </tr>
    <% document_types.each do |document_type| %>
    <tr>
      <td class="type"> <%= link_to document_type.name.pluralize, "#fr-index-#{document_type.name.pluralize.downcase}" %></td>
      <td class="entry_count"> <%= document_type.document_count %></td>
      <td class="subject_count"> <%= document_type.subject_count %></td>
    </tr>
    <% end %>
  </table>
</div>
