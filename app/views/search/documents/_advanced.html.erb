<%= render :partial => "search/date_form", :locals => {:f => f, :attribute => :publication_date, :label => "Publication Date"} %>
<%= render :partial => "search/date_form", :locals => {:f => f, :attribute => :effective_date, :label => "Effective Date"} %>
<%= render :partial => "search/date_form", :locals => {:f => f, :attribute => :comment_date, :label => "Comment Close Date"} %>

<%= f.inputs :class => 'show_labels' do %>
  <li class="string optional agency">
    <label>Agency</label>
    <input data-autocomplete="autocomplete" id="document-agency-search" placeholder="Agriculture Department" />

    <%= f.select :agency_ids,
      @presenter.agencies.map{|a| [a.name, a.id.to_s]},
      {},
      {
        multiple: true,
        class: 'selected_agency_list'
      } %>
  </li>

  <%= f.input :type,
    as: :check_boxes,
    collection: DocumentType.
      document_types_for_search.
      map{|t| [t.display_type, t.granule_class]},
    label: "Document Category",
    required: false %>

  <%= f.input :presidential_document_type_id,
    as: :check_boxes,
    collection: PresidentialDocumentType.all,
    label: "Presidential Document Type",
    required: false,
    wrapper_html: {class: "presidential_dependent"} %>

  <%= f.input :president,
    as: :check_boxes,
    collection: President.all,
    label: "President",
    required: false,
    value_method: :identifier,
    wrapper_html: {class: "presidential_dependent"} %>

  <%= f.input :docket_id,
    input_html: {:placeholder => "EPA-HQ-OPPT-2005-0049"},
    label: "Agency Docket",
    required: false,
    wrapper_html: {class: 'docket'} %>

  <%= f.input :regulation_id_number,
    input_html: {:placeholder => "2070-AJ57"},
    label: "Regulation ID Number (RIN)",
    required: false,
    wrapper_html: {class: 'reg_id'} %>

  <li class="boolean optional significant" id="conditions_significant_input">
    <label for="conditions_significant">
      <%= f.check_box :significant, {}, '1', '' %>
      Deemed Significant Under EO 12866
    </label>
  </li>

  <%= f.input :small_entity_ids,
    as: :check_boxes,
    collection: SmallEntity.all.map{|e| [e.name, e.id.to_s]},
    label: "Small Entities Affected",
    required: false %>
<% end %>

<%= f.fields_for :cfr do |cfr_f| %>
  <% f.inputs name: "Affecting CFR Part", class: 'cfr' do %>
    <%= cfr_f.input :title,
      input_html: {
        placeholder: 'title',
        value: @search.cfr.try(:title)
      },
      wrapper_html: {class: 'cfr_title'} %>

    <%= cfr_f.input :part,
      input_html: {
        placeholder: 'part',
        value: @search.cfr.try(:part)
      },
      wrapper_html: {class: 'cfr_part'} %>
  <% end %>
<% end %>

<%= f.fields_for :near do |location_f| %>
  <% f.inputs name: "Mentioning Locations Near", class: 'zip' do %>
    <%= location_f.input :location,
      input_html: {placeholder:  "Zip Code"},
      value: @search.near.try(:location) %>

    <%= location_f.input :within,
      as: :select,
      collection: [5, 10, 25, 50, 100, 200].map{|n| ["#{n} miles", n]},
      selected: @search.near.try(:within) %>
  <% end %>
<% end %>

<% [:topic_ids, :section_ids].each do |param| %>
  <% (params[:conditions] || {})[param].to_a.each do |val| %>
    <%= hidden_field_tag "conditions[#{param}][]", val %>
  <% end %>
<% end %>

<%= f.buttons do %>
  <%= f.commit_button 'Search', button_html: {
    id: 'conditions_submit',
    class: 'fr_button primary large'
  } %>

  <li>
    <%= link_to "Clear Form", documents_search_path({}),
      :class => "clear_form" %>
  </li>
<% end %>
